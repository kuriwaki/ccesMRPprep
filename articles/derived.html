<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deriving Variables • ccesMRPprep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Deriving Variables">
<meta property="og:description" content="ccesMRPprep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ccesMRPprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Workflow Overview</a>
    </li>
    <li>
      <a href="../articles/derived.html">Deriving Variables</a>
    </li>
    <li>
      <a href="../articles/acs.html">ACS Tables to Use for CCES and MRP</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/kuriwaki/ccesMRPprep/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Deriving Variables</h1>
                        <h4 class="author">Shiro Kuriwaki</h4>
            
            <h4 class="date">2020-06-08</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/kuriwaki/ccesMRPprep/blob/master/vignettes/derived.Rmd"><code>vignettes/derived.Rmd</code></a></small>
      <div class="hidden name"><code>derived.Rmd</code></div>

    </div>

    
    
<p>All survey questions are inherently discrete so the analyst must decide how to derive (or operationalize) that into a numeric indicator. This decision choice that rarely gets the limelight is a difficult operation to encode in a generic way.</p>
<div id="original-encodings-haven_labelled" class="section level1">
<h1 class="hasAnchor">
<a href="#original-encodings-haven_labelled" class="anchor"></a>Original Encodings (haven_labelled)</h1>
<p><code>factor</code> is a R variable class in which value comprises a value has a <em>level</em> and a <em>label</em> (See <a href="http://adv-r.had.co.nz/Data-structures.html#attributes">Advanced R</a> for a brief technical overview.). Both of these are necessary to store in survey design because the order in which the values were presented and the label matters. Even though the levels can be thought of as fundamentally as integers, the transformation from R factors to integers is actually cumbersome. <code><a href="https://rdrr.io/r/base/factor.html">?base::factor</a></code> recommends <code>as.numeric(levels(f))[f]</code> where <code>f</code> is a factor vector.</p>
<p><code>haven_labelled</code> is a separate R class that was defined in the <code>haven</code> package, a part of tidyverse that is designed to read Stata and SPSS files. Stata and SPSS have their own analogs to factors, but in Stata, these variables are literally integers/doubles with a <em>“labels”</em> attribute. This is a named vector where the values are the numbers and the labels are the <em>label</em> equivalent of factors (corresponding to Stata’s <code>label list [lblname]</code>). <code>haven_labelled</code> is a class that preserves this information (See <code><a href="https://haven.tidyverse.org/reference/labelled.html">?haven::labelled</a></code> help page or the <a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html">vignette</a> from the <code>labelled</code> package for more detail). For example, look at any of the variables in the CCES 2018 sample which contains a <code>lbl</code> tag:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">gov_approval_lbl</span> <span class="kw">&lt;-</span> <span class="fu">select</span>(<span class="no">cc18_samp</span>, <span class="no">case_id</span>, <span class="no">CC18_308d</span>)
<span class="no">gov_approval_lbl</span>
<span class="co">#&gt; # A tibble: 1,000 x 2</span>
<span class="co">#&gt;      case_id               CC18_308d</span>
<span class="co">#&gt;        &lt;dbl&gt;               &lt;dbl+lbl&gt;</span>
<span class="co">#&gt;  1 415395741 4 [Strongly disapprove]</span>
<span class="co">#&gt;  2 414164923 4 [Strongly disapprove]</span>
<span class="co">#&gt;  3 412379892 2 [Somewhat approve]   </span>
<span class="co">#&gt;  4 414203529 3 [Somewhat disapprove]</span>
<span class="co">#&gt;  5 412148048 1 [Strongly approve]   </span>
<span class="co">#&gt;  6 412329835 2 [Somewhat approve]   </span>
<span class="co">#&gt;  7 417352072 4 [Strongly disapprove]</span>
<span class="co">#&gt;  8 414614677 1 [Strongly approve]   </span>
<span class="co">#&gt;  9 416797006 1 [Strongly approve]   </span>
<span class="co">#&gt; 10 412962561 1 [Strongly approve]   </span>
<span class="co">#&gt; # … with 990 more rows</span></pre></body></html></div>
<p>Recent versions of <code>haven</code> (&gt;= 2.1.0) will display the labels in square brackets if the dataset is a tibble, but we can see that the values are basically doubles. If we had used factors, these numerical values would be obscured, though the levels and labels will be kept.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">gov_approval_fct</span> <span class="kw">&lt;-</span> <span class="fu">transmute</span>(<span class="no">cc18_samp</span>, <span class="no">case_id</span>, <span class="kw">CC18_308d</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">CC18_308d</span>))
<span class="no">gov_approval_fct</span>
<span class="co">#&gt; # A tibble: 1,000 x 2</span>
<span class="co">#&gt;      case_id CC18_308d          </span>
<span class="co">#&gt;        &lt;dbl&gt; &lt;fct&gt;              </span>
<span class="co">#&gt;  1 415395741 Strongly disapprove</span>
<span class="co">#&gt;  2 414164923 Strongly disapprove</span>
<span class="co">#&gt;  3 412379892 Somewhat approve   </span>
<span class="co">#&gt;  4 414203529 Somewhat disapprove</span>
<span class="co">#&gt;  5 412148048 Strongly approve   </span>
<span class="co">#&gt;  6 412329835 Somewhat approve   </span>
<span class="co">#&gt;  7 417352072 Strongly disapprove</span>
<span class="co">#&gt;  8 414614677 Strongly approve   </span>
<span class="co">#&gt;  9 416797006 Strongly approve   </span>
<span class="co">#&gt; 10 412962561 Strongly approve   </span>
<span class="co">#&gt; # … with 990 more rows</span></pre></body></html></div>
<p>For using CCES outcomes, the <strong>haven_labelled</strong> class is more concise then factors, for the following reasons:</p>
<ol style="list-style-type: decimal">
<li>It is closer to the original format of the data as exported by YouGov (SPSS)</li>
<li>Creating derived variables via operators is more concise (think <code>gov_approval &lt;= 2</code> instead of <code>gov_approval %in% c("Strongly approve", "approve")</code>).</li>
</ol>
<p>The second point is consequential. For example suppose we want to model a derived variable, Governor approval, which is 1 if the respondent strongly approves or approves of the governor. With the haven_labelled class, we can do what we would do in Stata:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">gov_approval_lbl</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="no">CC18_308d</span> <span class="kw">&lt;=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu">count</span>(<span class="no">CC18_308d</span>, <span class="no">outcome</span>)
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;                  CC18_308d outcome     n</span>
<span class="co">#&gt;                  &lt;dbl+lbl&gt; &lt;lgl&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1  1 [Strongly approve]    TRUE      144</span>
<span class="co">#&gt; 2  2 [Somewhat approve]    TRUE      307</span>
<span class="co">#&gt; 3  3 [Somewhat disapprove] FALSE     170</span>
<span class="co">#&gt; 4  4 [Strongly disapprove] FALSE     265</span>
<span class="co">#&gt; 5  5 [Not sure]            FALSE     112</span>
<span class="co">#&gt; 6 NA                       NA          2</span></pre></body></html></div>
<p>But this will not work with factors,</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">gov_approval_fct</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="no">CC18_308d</span> <span class="kw">&lt;=</span> <span class="st">"Somewhat approve"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">count</span>(<span class="no">outcome</span>)
<span class="co">#&gt; Warning in Ops.factor(CC18_308d, "Somewhat approve"): '&lt;=' not meaningful for</span>
<span class="co">#&gt; factors</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   outcome     n</span>
<span class="co">#&gt;   &lt;lgl&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 NA       1000</span></pre></body></html></div>
<p>That means, with factors, we would need to figure out all the labels and type them up exactly as they appear. In surveys, the labels can be long and contain punctuation which is easy to miss. Of course we can extract these from attributes and save the trouble of hand-entering them, but the same information is available in the haven_labelled class too.</p>
<p>On the other hand, <code>haven_labelled</code> is a bit inconvenient because the raw number is not immediately informative. A quick way to transform the numerical data to its labels is <code><a href="https://haven.tidyverse.org/reference/as_factor.html">haven::as_factor</a></code> (notice this is different from <code><a href="https://rdrr.io/r/base/factor.html">base::as.factor</a></code>). Or, for metadata, we can look at its attributes:</p>
<p>In the <code>haven_labelled</code> class, three pieces of information are stored as attributes:</p>
<ol style="list-style-type: decimal">
<li>
<code>label</code>: Description of the entire variable (this contains a short version of the question or an indication of the question in CCES data)</li>
<li>
<code>labels</code>: Label-Value keyvalue pairs.</li>
</ol>
<p>We can use <code>str</code> and <code>attr</code> to view and extract these metadata:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">gov_approval_lbl</span>$<span class="no">CC18_308d</span>)
<span class="co">#&gt;  'haven_labelled' num [1:1000] 4 4 2 3 1 2 4 1 1 1 ...</span>
<span class="co">#&gt;  - attr(*, "label")= chr "Job approval -- The Governor of $inputstate"</span>
<span class="co">#&gt;  - attr(*, "labels")= Named num [1:7] 1 2 3 4 5 8 9</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:7] "Strongly approve" "Somewhat approve" "Somewhat disapprove" "Strongly disapprove" ...</span></pre></body></html></div>
<p>For example, this indicates that <code>CC18_308d</code> is about <code>"Job approval -- The Governor of $inputstate"</code>. This is <em>not</em> the question wording verbatim, of course. This is something that needs to be looked up in the Word Doc YouGov questionnaires each time, or in the CCES codebooks (Shiro and the CCES team has some of this in plain-text tabular form for recent years).</p>
<p>And the possible values are</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">gov_approval_lbl</span>$<span class="no">CC18_308d</span>, <span class="st">"labels"</span>)
<span class="co">#&gt;    Strongly approve    Somewhat approve Somewhat disapprove Strongly disapprove </span>
<span class="co">#&gt;                   1                   2                   3                   4 </span>
<span class="co">#&gt;            Not sure             skipped           not asked </span>
<span class="co">#&gt;                   5                   8                   9</span></pre></body></html></div>
<p>where again the numbers are the values and the labels attribute of the vector are the value labels.</p>
<p>As long as we retain these attributes (which is possible as long as haven is loaded), we can express derivation in a simple way.</p>
</div>
<div id="question-types" class="section level1">
<h1 class="hasAnchor">
<a href="#question-types" class="anchor"></a>Question Types</h1>
<p>Another thing this metadata <em>does not</em> include is whether the response options are binary, ordinal, or categorical (no inherent ordering). This is something we need to hand-classify, although it is usually obvious once we see the question.</p>
<p>We consider the of the most common types below. These are from the sample question metadata (see the <code>q_type</code> variable):</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">questions_samp</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">q_ID</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CC18_322C"</span>,<span class="st">"CC18_308d"</span>, <span class="st">"CC18_pid3"</span>))
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;   q_ID      q_label                           cces_data q_code    response_type</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                             &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;        </span>
<span class="co">#&gt; 1 CC18_322C Withold Sanctuary Funding         2018      CC18_322c yesno        </span>
<span class="co">#&gt; 2 CC18_308d Governor Approval                 2018      CC18_308d ordinal      </span>
<span class="co">#&gt; 3 CC18_pid3 Partisan Identification (3-point) 2018      pid3      categorical</span></pre></body></html></div>
<p>This classification narrows down the type of function we would use for deriving a variable.</p>
<p><strong>All three types</strong> can be derived by the basic atomic operator:</p>
<pre><code>outcome = lbl_var %in% c(v1, v2, v3, ...)</code></pre>
<p>where <code>outcome</code> is the derived variable, <code>lbl_var</code> the data vector of class <code>haven_labelled</code>, and <code><a href="https://rdrr.io/r/base/c.html">c(v1, v2, v3, ...)</a></code> is a vector of one or more in the data vector that that we consider a success.</p>
<p>For this project we only consider binomial models, which is why this is sufficient. Survey data is almost never continuous, and running multinomial models in MRP is still exceedingly uncommon.</p>
<div id="yes-no-variables---use-yesno_to_binary" class="section level2">
<h2 class="hasAnchor">
<a href="#yes-no-variables---use-yesno_to_binary" class="anchor"></a>1. Yes-No variables - use <code>yesno_to_binary</code>
</h2>
<p>This is the simplest case because there are only two options and it is almost always clear which of the two is naturally corresponds to a “success” instead of a “failure” in a Bernoulli random variable. That means we currently _only- use <code><a href="../reference/yesno_to_binary.html">yesno_to_binary()</a></code> for the derivation. For example, <code>CC18_322C</code> is a question asking for people’s support of a measure to withdraw federal funding for so-called “Sanctuary Cities”:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">cc18_samp</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">case_id</span>, <span class="no">CC18_322c</span>)
<span class="co">#&gt; # A tibble: 1,000 x 2</span>
<span class="co">#&gt;      case_id   CC18_322c</span>
<span class="co">#&gt;        &lt;dbl&gt;   &lt;dbl+lbl&gt;</span>
<span class="co">#&gt;  1 415395741 2 [Oppose] </span>
<span class="co">#&gt;  2 414164923 1 [Support]</span>
<span class="co">#&gt;  3 412379892 2 [Oppose] </span>
<span class="co">#&gt;  4 414203529 1 [Support]</span>
<span class="co">#&gt;  5 412148048 2 [Oppose] </span>
<span class="co">#&gt;  6 412329835 2 [Oppose] </span>
<span class="co">#&gt;  7 417352072 2 [Oppose] </span>
<span class="co">#&gt;  8 414614677 2 [Oppose] </span>
<span class="co">#&gt;  9 416797006 1 [Support]</span>
<span class="co">#&gt; 10 412962561 1 [Support]</span>
<span class="co">#&gt; # … with 990 more rows</span></pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">cc18_samp</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">case_id</span>, <span class="no">CC18_322c</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="../reference/yesno_to_binary.html">yesno_to_binary</a></span>(<span class="fu">as_factor</span>(<span class="no">CC18_322c</span>))) <span class="kw">%&gt;%</span>
  <span class="fu">count</span>(<span class="no">CC18_322c</span>, <span class="no">outcome</span>)
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;      CC18_322c outcome     n</span>
<span class="co">#&gt;      &lt;dbl+lbl&gt;   &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1  1 [Support]       1   466</span>
<span class="co">#&gt; 2  2 [Oppose]        0   533</span>
<span class="co">#&gt; 3 NA                NA     1</span></pre></body></html></div>
</div>
<div id="categorical-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-variables" class="anchor"></a>2. Categorical variables</h2>
<p>These have no inherent ordering, i.e. there is no likert scale or obvious scale. These can be vote choice for parties, race, religion, or method of voting. Here we show partisanship (on a 3 point multiple choice question).</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">cc18_samp</span>$<span class="no">pid3</span>)
<span class="co">#&gt;  'haven_labelled' num [1:1000] 3 2 1 2 3 3 1 1 2 3 ...</span>
<span class="co">#&gt;  - attr(*, "label")= chr "3 point party ID"</span>
<span class="co">#&gt;  - attr(*, "labels")= Named num [1:7] 1 2 3 4 5 8 9</span>
<span class="co">#&gt;   ..- attr(*, "names")= chr [1:7] "Democrat" "Republican" "Independent" "Other" ...</span></pre></body></html></div>
<p>To make a derived variable out of this, we need <strong>a function that takes an ordered vector of value(s) that counts as a success</strong> . For example, let’s say we want to measure the proportion of independents. Then the derivation will be</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">cc18_samp</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">case_id</span>, <span class="no">pid3</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="no">pid3</span> <span class="kw">%in%</span> <span class="fl">3</span>) <span class="kw">%&gt;%</span>
  <span class="fu">count</span>(<span class="no">pid3</span>, <span class="no">outcome</span>)
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;              pid3 outcome     n</span>
<span class="co">#&gt;         &lt;dbl+lbl&gt; &lt;lgl&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 1 [Democrat]    FALSE     353</span>
<span class="co">#&gt; 2 2 [Republican]  FALSE     272</span>
<span class="co">#&gt; 3 3 [Independent] TRUE      279</span>
<span class="co">#&gt; 4 4 [Other]       FALSE      43</span>
<span class="co">#&gt; 5 5 [Not sure]    FALSE      53</span></pre></body></html></div>
<p>because <code>3</code> stands for independent in this case, as can be seen from the metadata.</p>
<p>Clearly, “Yes/No” variable type can be considered a type of categorical variable type. I still distinguish these between because in the former, the analyst does need to make a decision about what consists as a success, whereas in <code>pid3</code> for example, three reasonable operations can exist and the what is a success as opposed to a failure is ambiguous from the name <code>pid3</code>.</p>
</div>
<div id="ordinal-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#ordinal-variables" class="anchor"></a>3. Ordinal variables</h2>
<p>Ordinal variables have a clear ordering in their labels and their values conform to that order, for example likert scales agree-disagree, approve-disagree, as well as measures like education, income, and news interest.</p>
<p>This means that derivation can use operators <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code> and <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code> instead of simply <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> – as in the Governor approval example in the beginning. We may want to lump together this with a categorical variable, but again the distinction can be meaningful because in an ordinal variable one would almost never “skip” a value, as in <code>governor_approval %in% c(1, 3, 4)</code>, whereas in a categorical variable, one might do that depending on the order of the variables.</p>
<p><em>Note</em> one must be careful that almost all the variables considered here are not exhaustively “ordinal” because they have “Not Sure” / “Other” / “Not Asked” values as taking values of 8 or 9. For example, because <code>pid3 == 4</code> means “Other”, a derived variable defined as “pid3 &gt;= 3” is not very meaningful unless you are interested in the group of people who identify as “Independent” or “Other”.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">cc18_samp</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">case_id</span>, <span class="no">CC18_308d</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outcome</span> <span class="kw">=</span> <span class="no">CC18_308d</span> <span class="kw">&lt;=</span> <span class="fl">2</span>) <span class="kw">%&gt;%</span>
  <span class="fu">count</span>(<span class="no">CC18_308d</span>, <span class="no">outcome</span>)
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;                  CC18_308d outcome     n</span>
<span class="co">#&gt;                  &lt;dbl+lbl&gt; &lt;lgl&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1  1 [Strongly approve]    TRUE      144</span>
<span class="co">#&gt; 2  2 [Somewhat approve]    TRUE      307</span>
<span class="co">#&gt; 3  3 [Somewhat disapprove] FALSE     170</span>
<span class="co">#&gt; 4  4 [Strongly disapprove] FALSE     265</span>
<span class="co">#&gt; 5  5 [Not sure]            FALSE     112</span>
<span class="co">#&gt; 6 NA                       NA          2</span></pre></body></html></div>
</div>
</div>
<div id="other-considerations" class="section level1">
<h1 class="hasAnchor">
<a href="#other-considerations" class="anchor"></a>Other Considerations</h1>
<p>Missing Values</p>
<p>Generic versions of derivation</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.shirokuriwaki.com">Shiro Kuriwaki</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '1a2c0d939f9a70090cf27efbbac5ba52',
    indexName: 'ccesmrpprep',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
